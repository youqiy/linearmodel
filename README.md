# linearmodel

## Overview
This R-package is designed for performing a linear regression model and some
basic anaylses:

* `lr()` returns a list of results, including fitted values, residuals, a
summary of coefficients, degree of freedom, r-squared, residual standard error,
and f-test.

A unique design in this package is that it can be used in model without 
intercept, and model with interactions. Also, the function can be applied for categorical variables.

## Installation
```
# install packages from github
install.packages("devtools")
devtools::install_github("youqiy/linearmodel", build_vignettes = T)

# generate the tutorial
browseVignettes("multilinear") 
```

## Usage
```
# Load the package
library(linearmodel)

# Sample dataset
data(Angell)

# By default, the intercept is included, while the interactions are not.
lr(moral~hetero+mobility, data = Angell)
$y.fitted
                    [,1]
Rochester       14.804720
Syracuse        14.342287
Worcester       14.912519
Erie            15.559877
Milwaukee       14.649495
Bridgeport      13.528949
Buffalo         14.678162
Dayton          12.767024
Reading         15.039737
Des_Moines      12.395340
Cleveland       12.035298
Denver          11.860157
Peoria          11.993856
Wichita         10.394400
Trenton         13.358207
Grand_Rapids    13.558176
Toledo          13.680833
San_Diego        8.587633
Baltimore       12.629622
South_Bend      12.700741
Akron           13.453904
Detroit         12.013299
Tacoma          11.977005
Flint           11.620851
Spokane         11.085568
Seattle         10.734849
Indianapolis    12.305264
Columbus        12.133376
Portland_Oregon 11.239745
Richmond         8.038290
Houston          7.642702
Fort_Worth       9.515738
Oklahoma_City    8.569162
Chattanooga      8.418723
Nashville        8.799256
Birmingham       5.912612
Dallas           8.638498
Louisville      12.770837
Jacksonville     6.585110
Memphis          5.605977
Tulsa            8.677248
Miami            6.410542
Atlanta          5.974408

$residual
                      [,1]        [,2]
Rochester        4.1952803  1.94099158
Syracuse         2.6577126  1.21747961
Worcester        1.4874808  0.69098598
Erie             0.6401228  0.29829135
Milwaukee        1.1505046  0.52943495
Bridgeport       1.7710512  0.81001573
Buffalo          0.5218378  0.24139390
Dayton           1.5329765  0.69413531
Reading         -0.8397374 -0.38763589
Des_Moines       1.7046598  0.77832621
Cleveland        1.9647020  0.89688664
Denver           2.0398434  0.93427860
Peoria           1.8061441  0.83026294
Wichita          3.2056002  1.50428589
Trenton         -0.3582070 -0.16452018
Grand_Rapids    -0.7581765 -0.34515315
Toledo          -0.9808329 -0.44670151
San_Diego        3.9123668  1.89717506
Baltimore       -0.6296224 -0.29452713
South_Bend      -0.9007410 -0.40850105
Akron           -2.1539042 -0.97931160
Detroit         -0.9132994 -0.41588005
Tacoma          -1.0770048 -0.48910059
Flint           -1.8208514 -0.82679230
Spokane         -1.4855681 -0.68776751
Seattle         -1.7348488 -0.78795599
Indianapolis    -3.5052642 -1.58559925
Columbus        -4.1333758 -1.86711152
Portland_Oregon -4.0397454 -1.84875559
Richmond         2.3617095  1.10354301
Houston          2.5572984  1.17673271
Fort_Worth       0.6842616  0.31203789
Oklahoma_City    1.1308382  0.53817588
Chattanooga      0.8812766  0.40585039
Nashville       -0.1992561 -0.09174117
Birmingham       2.2873878  1.12348625
Dallas          -0.6384979 -0.29230833
Louisville      -5.0708374 -2.30722679
Jacksonville    -0.5851097 -0.27903294
Memphis         -0.2059775 -0.10169540
Tulsa           -3.3772479 -1.58638559
Miami           -1.3105416 -0.61513883
Atlanta         -1.7744078 -0.84360005

$cov.matrix
              Estimate  Std.Error   t value     Pr(>|t|)
(Intercept) 19.9407576 1.19265243 16.719672 0.000000e+00
hetero      -0.1085598 0.01699063 -6.389393 1.340419e-07
mobility    -0.1933137 0.03542855 -5.456440 2.739345e-06

$df
[1] 40

$r.squared
          [,1]
[1,] 0.6243781

$sigma
[1] 2.243133

$f.result
[1] 3.324503e+01 2.000000e+00 4.000000e+01 3.126213e-09

# When intercept = FALSE, the model would not include the intercept.
lr(moral~hetero+mobility, data = Angell, intercept = FALSE)
$y.fitted
                     [,1]
Rochester        5.312934
Syracuse         6.754184
Worcester        4.929980
Erie             5.033409
Milwaukee        6.010465
Bridgeport       6.325992
Buffalo          5.276354
Dayton           8.133411
Reading          6.342115
Des_Moines      10.272481
Cleveland        7.055072
Denver          11.085483
Peoria          11.194934
Wichita         13.582062
Trenton          5.952648
Grand_Rapids     7.993030
Toledo           7.305397
San_Diego       15.907125
Baltimore        5.248560
South_Bend       9.054049
Akron            7.499430
Detroit          7.286881
Tacoma          10.224519
Flint           10.582894
Spokane         12.421490
Seattle         11.352430
Indianapolis     8.098646
Columbus         8.626145
Portland_Oregon 11.599209
Richmond         9.845653
Houston         12.767413
Fort_Worth      12.373282
Oklahoma_City   15.262381
Chattanooga     10.305353
Nashville        9.739459
Birmingham      10.741796
Dallas          12.890018
Louisville       7.031647
Jacksonville    10.987668
Memphis         11.035094
Tulsa           14.654217
Miami           14.567657
Atlanta         12.398937

$residual
                       [,1]         [,2]
Rochester       13.68706624  2.193871252
Syracuse        10.24581582  1.646022754
Worcester       11.47001951  1.839135572
Erie            11.16659062  1.788515838
Milwaukee        9.78953541  1.569887369
Bridgeport       8.97400829  1.442454944
Buffalo          9.92364585  1.591362873
Dayton           6.16658903  0.992396247
Reading          7.85788499  1.263387303
Des_Moines       3.82751934  0.624938160
Cleveland        6.94492768  1.125264404
Denver           2.81451659  0.461646851
Peoria           2.60506618  0.428846172
Wichita          0.01793765  0.003003168
Trenton          7.04735241  1.136134952
Grand_Rapids     4.80697022  0.775010863
Toledo           5.39460345  0.867070060
San_Diego       -3.40712512 -0.578906564
Baltimore        6.75143951  1.107892129
South_Bend       2.74595075  0.443911048
Akron            3.80056978  0.611008713
Detroit          3.81311851  0.616866080
Tacoma           0.67548087  0.109755529
Flint           -0.78289370 -0.127284789
Spokane         -2.82149006 -0.467578948
Seattle         -2.35243000 -0.382666275
Indianapolis     0.70135376  0.112911847
Columbus        -0.62614521 -0.100861109
Portland_Oregon -4.39920872 -0.721112976
Richmond         0.55434744  0.092665012
Houston         -2.56741322 -0.419024466
Fort_Worth      -2.17328222 -0.353924413
Oklahoma_City   -5.56238146 -0.931465582
Chattanooga     -1.00535270 -0.165619268
Nashville       -1.13945923 -0.187858229
Birmingham      -2.54179639 -0.442757738
Dallas          -4.89001829 -0.796514147
Louisville       0.66835263  0.107623522
Jacksonville    -4.98766766 -0.845361779
Memphis         -5.63509444 -0.984003100
Tulsa           -9.35421742 -1.552170519
Miami           -9.46765721 -1.551638156
Atlanta         -8.19893687 -1.373524578

$cov.matrix
           Estimate  Std.Error   t value     Pr(>|t|)
hetero   0.03299198 0.04112547 0.8022274 4.270471e-01
mobility 0.30888660 0.05245145 5.8890002 6.223330e-07

$df
[1] 41

$r.squared
        [,1]
[1,] 0.72885

$sigma
[1] 6.262254

$f.result
[1] 5.510392e+01 2.000000e+00 4.100000e+01 2.403189e-12

# When interaction = TRUE, the model would include the interactions between covariates.
lr(moral~hetero+mobility, data = Angell, interact = TRUE)
$y.fitted
                     [,1]
Rochester       14.644583
Syracuse        14.144796
Worcester       14.787372
Erie            15.201806
Milwaukee       14.439700
Bridgeport      13.565613
Buffalo         14.565976
Dayton          12.721759
Reading         14.728660
Des_Moines      12.468056
Cleveland       12.314343
Denver          11.999881
Peoria          12.186182
Wichita         10.789934
Trenton         13.532499
Grand_Rapids    13.445297
Toledo          13.564593
San_Diego        8.995246
Baltimore       13.342430
South_Bend      12.657235
Akron           13.360058
Detroit         12.235687
Tacoma          11.994152
Flint           11.639937
Spokane         11.360200
Seattle         10.715419
Indianapolis    12.318899
Columbus        12.116546
Portland_Oregon 11.354925
Richmond         8.287983
Houston          7.172571
Fort_Worth       9.372259
Oklahoma_City    8.717428
Chattanooga      8.445822
Nashville        8.957051
Birmingham       6.156594
Dallas           8.344231
Louisville      12.864532
Jacksonville     6.587102
Memphis          5.749627
Tulsa            8.686236
Miami            5.595172
Atlanta          5.471607

$residual
                      [,1]       [,2]
Rochester        4.3554172  2.0139978
Syracuse         2.8552040  1.3102516
Worcester        1.6126284  0.7473799
Erie             0.9981939  0.4739919
Milwaukee        1.3602997  0.6276887
Bridgeport       1.7343866  0.7893339
Buffalo          0.6340237  0.2924375
Dayton           1.5782415  0.7111897
Reading         -0.5286600 -0.2471054
Des_Moines       1.6319438  0.7419631
Cleveland        1.6856572  0.7762060
Denver           1.9001193  0.8687866
Peoria           1.6138185  0.7429255
Wichita          2.8100664  1.3516607
Trenton         -0.5324989 -0.2446301
Grand_Rapids    -0.6452971 -0.2928996
Toledo          -0.8645933 -0.3926552
San_Diego        3.5047535  1.7492650
Baltimore       -1.3424297 -0.6929636
South_Bend      -0.8572347 -0.3868878
Akron           -2.0600577 -0.9332337
Detroit         -1.1356871 -0.5189752
Tacoma          -1.0941522 -0.4943450
Flint           -1.8399369 -0.8311932
Spokane         -1.7601997 -0.8219683
Seattle         -1.7154195 -0.7751554
Indianapolis    -3.5188995 -1.5835913
Columbus        -4.1165461 -1.8499890
Portland_Oregon -4.1549253 -1.8960812
Richmond         2.1120168  0.9932219
Houston          3.0274291  1.4439359
Fort_Worth       0.8277410  0.3768779
Oklahoma_City    0.9825721  0.4671609
Chattanooga      0.8541780  0.3913891
Nashville       -0.3570509 -0.1642750
Birmingham       2.0434056  1.0107620
Dallas          -0.3442311 -0.1592291
Louisville      -5.1645321 -2.3412993
Jacksonville    -0.5871018 -0.2785362
Memphis         -0.3496270 -0.1724582
Tulsa           -3.3862362 -1.5824108
Miami           -0.4951720 -0.2664054
Atlanta         -1.2716074 -0.6326447

$cov.matrix
                    Estimate   Std.Error    t value     Pr(>|t|)
(Intercept)     18.338650607 2.409427861  7.6112055 3.150018e-09
hetero          -0.045632694 0.083848297 -0.5442292 5.893820e-01
mobility        -0.137347822 0.081231915 -1.6908111 9.885111e-02
hetero*mobility -0.002245362 0.002929149 -0.7665579 4.479598e-01

$df
[1] 39

$r.squared
          [,1]
[1,] 0.6299536

$sigma
[1] 2.254786

$f.result
[1] 2.213072e+01 3.000000e+00 3.900000e+01 1.557516e-08

# Regarding the categorical variables, if category = 1, a reference cell coding is performed.
lr(moral~region, data = Angell, category = 1)
$y.fitted
           [,1]
 [1,] 15.366667
 [2,] 15.366667
 [3,] 15.366667
 [4,] 15.366667
 [5,] 12.278571
 [6,] 15.366667
 [7,] 15.366667
 [8,] 12.278571
 [9,] 15.366667
[10,] 12.278571
[11,] 12.278571
[12,] 10.516667
[13,] 12.278571
[14,] 12.278571
[15,] 15.366667
[16,] 12.278571
[17,] 12.278571
[18,] 10.516667
[19,] 15.366667
[20,] 12.278571
[21,] 12.278571
[22,] 12.278571
[23,] 10.516667
[24,] 12.278571
[25,] 10.516667
[26,] 10.516667
[27,] 12.278571
[28,] 12.278571
[29,] 10.516667
[30,]  7.735714
[31,]  7.735714
[32,]  7.735714
[33,]  7.735714
[34,]  7.735714
[35,]  7.735714
[36,]  7.735714
[37,]  7.735714
[38,]  7.735714
[39,]  7.735714
[40,]  7.735714
[41,]  7.735714
[42,]  7.735714
[43,]  7.735714

$residual
             [,1]        [,2]
 [1,]  3.63333333  1.73475841
 [2,]  1.63333333  0.77984552
 [3,]  1.03333333  0.49337166
 [4,]  0.83333333  0.39788037
 [5,]  3.52142857  1.64501068
 [6,] -0.06666667 -0.03183043
 [7,] -0.16666667 -0.07957607
 [8,]  2.02142857  0.94429619
 [9,] -1.16666667 -0.55703252
[10,]  1.82142857  0.85086759
[11,]  1.72142857  0.80415329
[12,]  3.38333333  1.66837205
[13,]  1.52142857  0.71072469
[14,]  1.32142857  0.61729610
[15,] -2.36666667 -1.12998025
[16,]  0.52142857  0.24358170
[17,]  0.42142857  0.19686740
[18,]  1.98333333  0.97801120
[19,] -3.36666667 -1.60743669
[20,] -0.47857143 -0.22356129
[21,] -0.97857143 -0.45713278
[22,] -1.17857143 -0.55056138
[23,]  0.38333333  0.18902738
[24,] -2.47857143 -1.15784727
[25,] -0.91666667 -0.45202199
[26,] -1.51666667 -0.74789092
[27,] -3.47857143 -1.62499026
[28,] -4.27857143 -1.99870466
[29,] -3.31666667 -1.63549773
[30,]  2.66428571  1.24460240
[31,]  2.46428571  1.15117380
[32,]  2.46428571  1.15117380
[33,]  1.96428571  0.91760231
[34,]  1.56428571  0.73074511
[35,]  0.86428571  0.40374501
[36,]  0.46428571  0.21688782
[37,]  0.26428571  0.12345922
[38,] -0.03571429 -0.01668368
[39,] -1.73571429 -0.81082676
[40,] -2.33571429 -1.09111256
[41,] -2.43571429 -1.13782686
[42,] -2.63571429 -1.23125546
[43,] -3.53571429 -1.65168415

$cov.matrix
             Estimate Std.Error   t value     Pr(>|t|)
(Intercept) 15.366667 0.7404935 20.751927 0.000000e+00
MW          -3.088095 0.9491201 -3.253640 2.356278e-03
S           -7.630952 0.9491201 -8.040029 8.370658e-10
W           -4.850000 1.1708230 -4.142385 1.784849e-04

$df
[1] 39

$r.squared
          [,1]
[1,] 0.6408047

$sigma
[1] 2.22148

$f.result
[1] 2.319201e+01 3.000000e+00 3.900000e+01 8.786565e-09

# If category = 2, then a cell means coding is performed.
lr(moral~region, data = Angell, category = 2)
$y.fitted
           [,1]
 [1,] 15.366667
 [2,] 15.366667
 [3,] 15.366667
 [4,] 15.366667
 [5,] 12.278571
 [6,] 15.366667
 [7,] 15.366667
 [8,] 12.278571
 [9,] 15.366667
[10,] 12.278571
[11,] 12.278571
[12,] 10.516667
[13,] 12.278571
[14,] 12.278571
[15,] 15.366667
[16,] 12.278571
[17,] 12.278571
[18,] 10.516667
[19,] 15.366667
[20,] 12.278571
[21,] 12.278571
[22,] 12.278571
[23,] 10.516667
[24,] 12.278571
[25,] 10.516667
[26,] 10.516667
[27,] 12.278571
[28,] 12.278571
[29,] 10.516667
[30,]  7.735714
[31,]  7.735714
[32,]  7.735714
[33,]  7.735714
[34,]  7.735714
[35,]  7.735714
[36,]  7.735714
[37,]  7.735714
[38,]  7.735714
[39,]  7.735714
[40,]  7.735714
[41,]  7.735714
[42,]  7.735714
[43,]  7.735714

$residual
             [,1]        [,2]
 [1,]  3.63333333  1.73475841
 [2,]  1.63333333  0.77984552
 [3,]  1.03333333  0.49337166
 [4,]  0.83333333  0.39788037
 [5,]  3.52142857  1.64501068
 [6,] -0.06666667 -0.03183043
 [7,] -0.16666667 -0.07957607
 [8,]  2.02142857  0.94429619
 [9,] -1.16666667 -0.55703252
[10,]  1.82142857  0.85086759
[11,]  1.72142857  0.80415329
[12,]  3.38333333  1.66837205
[13,]  1.52142857  0.71072469
[14,]  1.32142857  0.61729610
[15,] -2.36666667 -1.12998025
[16,]  0.52142857  0.24358170
[17,]  0.42142857  0.19686740
[18,]  1.98333333  0.97801120
[19,] -3.36666667 -1.60743669
[20,] -0.47857143 -0.22356129
[21,] -0.97857143 -0.45713278
[22,] -1.17857143 -0.55056138
[23,]  0.38333333  0.18902738
[24,] -2.47857143 -1.15784727
[25,] -0.91666667 -0.45202199
[26,] -1.51666667 -0.74789092
[27,] -3.47857143 -1.62499026
[28,] -4.27857143 -1.99870466
[29,] -3.31666667 -1.63549773
[30,]  2.66428571  1.24460240
[31,]  2.46428571  1.15117380
[32,]  2.46428571  1.15117380
[33,]  1.96428571  0.91760231
[34,]  1.56428571  0.73074511
[35,]  0.86428571  0.40374501
[36,]  0.46428571  0.21688782
[37,]  0.26428571  0.12345922
[38,] -0.03571429 -0.01668368
[39,] -1.73571429 -0.81082676
[40,] -2.33571429 -1.09111256
[41,] -2.43571429 -1.13782686
[42,] -2.63571429 -1.23125546
[43,] -3.53571429 -1.65168415

$cov.matrix
    Estimate Std.Error  t value     Pr(>|t|)
E  15.366667 0.7404935 20.75193 0.000000e+00
MW 12.278571 0.5937156 20.68090 0.000000e+00
S   7.735714 0.5937156 13.02933 8.881784e-16
W  10.516667 0.9069156 11.59608 3.286260e-14

$df
[1] 39

$r.squared
          [,1]
[1,] 0.9675426

$sigma
[1] 2.22148

$f.result
[1] 290.6436   4.0000  39.0000   0.0000
```
